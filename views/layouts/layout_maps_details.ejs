<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('../partials/head'); %>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
      .img-fluid {
        width: 100%;
        max-width: 100%;
        height: 200px;
      }

      .scrollable-card-body {
        overflow-y: auto;
        /* Enable vertical scroll if content exceeds max-height */
      }

      #map {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }

      .card,
      .card-body,
      #map {
        height: 82vh;
        /* atau 100% jika dalam layout tertentu */
        width: 100%;
      }

      /* Overlay Container */
      .user-overlay {
        position: absolute;
        top: 100px;
        left: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 999;
        /* di atas Leaflet */
        pointer-events: none;
        /* map tetap bisa digeser */
      }

      /* User Card */
      .user-card {
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 10px;
        padding: 8px 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        min-width: 200px;
        pointer-events: auto;
        /* card bisa diklik */
      }

      /* Avatar */
      .user-avatar {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #4CAF50;
        margin-right: 10px;
      }

      /* Info */
      .user-info {
        display: flex;
        flex-direction: column;
      }

      .user-name {
        font-size: 14px;
        font-weight: 600;
        color: #333;
      }

      .user-id {
        font-size: 12px;
        color: #666;
      }

      /* STATUS DOT */
      .status-dot {
        display: inline-block;
        width: 9px;
        height: 9px;
        border-radius: 50%;
        margin-left: 6px;
      }

      .status-dot.online {
        background: #2ecc71;
        box-shadow: 0 0 6px #2ecc71;
      }

      .status-dot.offline {
        background: #e74c3c;
        box-shadow: 0 0 6px #e74c3c;
      }

      /* OPEN BUTTON */
      .btn-open {
        margin-left: auto;
        background: #3498db;
        color: #fff;
        border: none;
        padding: 4px 10px;
        font-size: 12px;
        border-radius: 6px;
        cursor: pointer;
      }

      .btn-open:hover {
        background: #1f78c1;
      }
    </style>
    <style>
      /* Tombol Chat */
      .chat-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 15px 25px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      /* Popup Chat (Sembunyi secara default) */
      .chat-popup {
        display: none;
        position: fixed;
        bottom: 80px;
        right: 20px;
        width: 300px;
        background-color: white;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        z-index: 1000;
      }

      .chat-header {
        background: #007bff;
        color: white;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        border-radius: 10px 10px 0 0;
      }

      .chat-body {
        height: 82vh;
        padding: 15px;
        overflow-y: auto;
      }

      .chat-footer {
        padding: 10px;
        display: flex;
        border-top: 1px solid #eee;
      }

      .chat-footer input {
        flex: 1;
        padding: 5px;
      }
    </style>
    <style>
      /* Container bubble */
      .chat-row {
        display: flex;
        margin-bottom: 12px;
      }

      /* Foto user */
      .chat-avatar {
        width: 38px;
        height: 38px;
        border-radius: 50%;
        margin-right: 10px;
      }

      .chat-avatar-right {
        margin-left: 10px;
        margin-right: 0;
      }

      /* Bubble pesan */
      .chat-bubble {
        max-width: 65%;
        padding: 10px 14px;
        border-radius: 16px;
        position: relative;
        word-wrap: break-word;
        font-size: 15px;
        line-height: 1.4;
      }

      /* Bubble kiri (orang lain) */
      .chat-left .chat-bubble {
        background: #ffffff;
        border: 1px solid #ddd;
      }

      /* Bubble kanan (milik kita sendiri) */
      .chat-right {
        justify-content: flex-end;
      }

      .chat-right .chat-bubble {
        background: #dcf8c6;
        /* warna WhatsApp */
        border: 1px solid #cdebb4;
      }

      /* Nama pengirim */
      .chat-name {
        font-weight: bold;
        margin-bottom: 3px;
        font-size: 13px;
      }

      /* Timestamp kecil */
      .chat-time {
        font-size: 11px;
        text-align: right;
        opacity: 0.6;
        margin-top: 4px;
      }

      .tick {
        font-size: 12px;
        margin-left: 4px;
        color: #888;
      }

      .tick-blue {
        color: #0bb2ff;
      }

      .wa-unread-badge {
        background: #25d366;
        color: white;
        font-size: 12px;
        min-width: 20px;
        height: 20px;
        padding: 0 6px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: auto;
      }

      .chat-date-separator {
        text-align: center;
        margin: 12px 0;
      }

      .chat-date-separator span {
        background: #e5e5e5;
        padding: 4px 12px;
        border-radius: 8px;
        font-size: 12px;
        color: #555;
      }

      /* INPUT BOX */
      .wa-chat-input {
        padding: 10px;
        background: #f0f0f0;
        display: flex;
        border-top: 1px solid #ddd;
      }

      .wa-chat-input input {
        flex: 1;
        padding: 10px 15px;
        border-radius: 20px;
        border: none;
        outline: none;
        background: #fff;
      }

      .wa-chat-input button {
        margin-left: 12px;
        padding: 10px 20px;
        border-radius: 20px;
        border: none;
        background: #4caf50;
        color: #fff;
        cursor: pointer;
      }
    </style>
</head>

<body class="layout-fixed sidebar-mini sidebar-collapse" style="height: auto;">
  <div class="wrapper">

    <%- include('../partials/navbar'); %>
      <%- include('../partials/sidebar'); %>

        <div class="content-wrapper">
          <%- body %>
        </div>

        <%- include('../partials/footer'); %>

  </div>

  <%- include('../partials/scripts_activity_details'); %>
</body>

</html>